<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>NGL Spammer</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      .typed-cursor {
        display: none !important;
      }
      .preloader-wrapper {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
      }
      
      #lottie-loader {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 9999;
        width: 150px;
        height: 150px;
        display: none;
      }
    </style>
  </head>
  <body class="blue-grey darken-4">
    <div class="container">
      <div class="row">
        <div class="col s12 m8 offset-m2 l6 offset-l3">
          <div class="card z-depth-5">
            <div class="card-content">
              <div id="typed-output" class="center-align" style="margin-bottom: 20px; font-size: 1.5rem; color: #64b5f6;"></div>
              <span class="card-title center-align">NGL Spammer</span>
              <form id="spamForm">
                <div class="input-field">
                  <i class="material-icons prefix">account_circle</i>
                  <input id="username" name="username" type="text" required />
                  <label for="username">NGL Username</label>
                </div>
                <div class="input-field">
                  <i class="material-icons prefix">message</i>
                  <input id="message" name="message" type="text" required />
                  <label for="message">Message</label>
                </div>
                <div class="input-field">
                  <i class="material-icons prefix">repeat</i>
                  <input id="amount" name="amount" type="number" min="1" required />
                  <label for="amount">Amount</label>
                </div>
                <div class="center-align">
                  <button class="btn waves-effect waves-light" type="submit">
                    Spam
                    <i class="material-icons right">send</i>
                  </button>
                </div>
              </form>
              <div id="result" class="center-align" style="margin-top: 20px;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Lottie Loader -->
    <div id="lottie-loader"></div>

    <a href="https://www.facebook.com/Churchill.Dev4100" target="_blank" style="
      position: fixed;
      bottom: 15px;
      right: 15px;
      background: linear-gradient(45deg, #1e88e5, #64b5f6);
      color: white;
      padding: 10px 15px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      text-decoration: none;
      z-index: 9999;
      transition: transform 0.3s ease;
    ">Made with ❤️ by Churchill</a>
    <style>
      a[href="https://www.facebook.com/Churchill.Dev4100"]:hover {
        transform: scale(1.05);
      }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
    <script>
      // Lottie Animation for loading
      const loader = lottie.loadAnimation({
        container: document.getElementById('lottie-loader'),
        renderer: 'svg',
        loop: true,
        autoplay: false,
        path: 'https://assets10.lottiefiles.com/packages/lf20_usmfx6bp.json' // Replace with your preferred animation
      });

      document.addEventListener('DOMContentLoaded', function () {
        M.AutoInit();
        const typedElement = document.getElementById('typed-output');
        new Typed('#typed-output', {
          strings: [
            'Welcome!',
            'Yokuzo... watashi wa Soul Society da.',
            'Ore ga... Gundam da.',
            'Ore wa ten ni tatsu!',
            'Kono umi de ichiban jiyuu na otoko da!',
            'Ore wa ningen wo yameru zo, JoJo!',
            'Sentouryoku... tatta no go ka. Gomi me.'
          ],
          typeSpeed: 50,
          backSpeed: 25,
          backDelay: 1200,
          loop: false,
          showCursor: false,
          onComplete: () => {
            setTimeout(() => {
              typedElement.style.display = 'none';
            }, 1000);
          }
        });
      });

      document.getElementById('spamForm').addEventListener('submit', async function (e) {
        e.preventDefault();
        const form = e.target;
        const data = {
          username: form.username.value,
          message: form.message.value,
          amount: form.amount.value,
        };
        document.getElementById('lottie-loader').style.display = 'block';
        loader.play(); // Start the Lotto pepito
        try {
          const res = await fetch('/api/nglspam', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          });
          const result = await res.json();
          document.getElementById('lottie-loader').style.display = 'none';
          loader.stop(); 
          if (result.message) {
            Swal.fire({
              icon: 'success',
              title: 'Success!',
              text: result.message,
              confirmButtonColor: '#64b5f6'
            });
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Error',
              text: result.error || 'Something went wrong',
              confirmButtonColor: '#ef5350'
            });
          }
        } catch (err) {
          document.getElementById('lottie-loader').style.display = 'none';
          loader.stop();
          Swal.fire({
            icon: 'error',
            title: 'Oops!',
            text: 'Failed to send message.',
            confirmButtonColor: '#ef5350'
          });
        }
      });
    </script>
  </body>
</html>
